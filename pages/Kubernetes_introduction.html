<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Kubernetes - introduction – De.KCD - Data Management Platform on the Cloud - Quickstart</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-29a19b5acbeac218a8c860e48340d4df.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">De.KCD - Data Management Platform on the Cloud - Quickstart</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/abecam/DeKCD-DMOnTheCloud" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../pages/Kubernetes_introduction.html">Kubernetes</a></li><li class="breadcrumb-item"><a href="../pages/Kubernetes_introduction.html">Kubernetes - introduction</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">De.KCD - Data Management Platform on the Cloud, step by step</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/TechPlatformDecisionTree.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Technical Platform decision tree for Data Management Platforms</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Management Principles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/DM_planning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DataManagement - Planning</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Kubernetes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Kubernetes_introduction.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Kubernetes - introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Volumes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Volumes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/Backups_and_security.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Backups and Security</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Scrap pages</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../roadblocks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scrap page: roadblocks, difficulties to remove or solutions to issues</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../to_investigate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scrap page: things to investigate</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#working-progress" id="toc-working-progress" class="nav-link active" data-scroll-target="#working-progress"><span class="header-section-number">1</span> Working progress</a></li>
  <li><a href="#our-showcase-application-fairdom-seek" id="toc-our-showcase-application-fairdom-seek" class="nav-link" data-scroll-target="#our-showcase-application-fairdom-seek"><span class="header-section-number">2</span> Our showcase application: [FAIRDOM Seek]</a>
  <ul class="collapse">
  <li><a href="#seek-and-his-components" id="toc-seek-and-his-components" class="nav-link" data-scroll-target="#seek-and-his-components"><span class="header-section-number">2.1</span> Seek and his components</a></li>
  <li><a href="#the-default-docker-compose" id="toc-the-default-docker-compose" class="nav-link" data-scroll-target="#the-default-docker-compose"><span class="header-section-number">2.2</span> The default Docker Compose</a></li>
  <li><a href="#what-could-benefit-from-a-cloud-setup" id="toc-what-could-benefit-from-a-cloud-setup" class="nav-link" data-scroll-target="#what-could-benefit-from-a-cloud-setup"><span class="header-section-number">2.3</span> What could benefit from a cloud setup</a></li>
  </ul></li>
  <li><a href="#a-quick-overview-of-kubernetes" id="toc-a-quick-overview-of-kubernetes" class="nav-link" data-scroll-target="#a-quick-overview-of-kubernetes"><span class="header-section-number">3</span> A quick overview of Kubernetes</a>
  <ul class="collapse">
  <li><a href="#good-free-instructory-resources" id="toc-good-free-instructory-resources" class="nav-link" data-scroll-target="#good-free-instructory-resources"><span class="header-section-number">3.1</span> Good free instructory resources</a>
  <ul class="collapse">
  <li><a href="#tutorials-and-sandboxes" id="toc-tutorials-and-sandboxes" class="nav-link" data-scroll-target="#tutorials-and-sandboxes"><span class="header-section-number">3.1.1</span> Tutorials and sandboxes</a></li>
  <li><a href="#simple-kubernetes-setup" id="toc-simple-kubernetes-setup" class="nav-link" data-scroll-target="#simple-kubernetes-setup"><span class="header-section-number">3.1.2</span> Simple Kubernetes setup</a></li>
  </ul></li>
  <li><a href="#terminology-main-elements" id="toc-terminology-main-elements" class="nav-link" data-scroll-target="#terminology-main-elements"><span class="header-section-number">3.2</span> Terminology &amp; main elements</a></li>
  <li><a href="#everything-decoupled" id="toc-everything-decoupled" class="nav-link" data-scroll-target="#everything-decoupled"><span class="header-section-number">3.3</span> Everything decoupled</a></li>
  <li><a href="#the-various-objects-for-your-application" id="toc-the-various-objects-for-your-application" class="nav-link" data-scroll-target="#the-various-objects-for-your-application"><span class="header-section-number">3.4</span> The various objects for your application</a></li>
  <li><a href="#visual-overview" id="toc-visual-overview" class="nav-link" data-scroll-target="#visual-overview"><span class="header-section-number">3.5</span> Visual overview</a></li>
  <li><a href="#updating-an-application" id="toc-updating-an-application" class="nav-link" data-scroll-target="#updating-an-application"><span class="header-section-number">3.6</span> Updating an application</a></li>
  <li><a href="#where-do-you-store-the-data" id="toc-where-do-you-store-the-data" class="nav-link" data-scroll-target="#where-do-you-store-the-data"><span class="header-section-number">3.7</span> Where do you store the data</a>
  <ul class="collapse">
  <li><a href="#a-note-about-automatic-storage-storageclass" id="toc-a-note-about-automatic-storage-storageclass" class="nav-link" data-scroll-target="#a-note-about-automatic-storage-storageclass"><span class="header-section-number">3.7.1</span> A note about automatic storage (StorageClass)</a></li>
  <li><a href="#visual-overview-of-automatic-storage-provisioning" id="toc-visual-overview-of-automatic-storage-provisioning" class="nav-link" data-scroll-target="#visual-overview-of-automatic-storage-provisioning"><span class="header-section-number">3.7.2</span> Visual overview of automatic storage provisioning</a></li>
  <li><a href="#visual-overview-of-storage" id="toc-visual-overview-of-storage" class="nav-link" data-scroll-target="#visual-overview-of-storage"><span class="header-section-number">3.7.3</span> Visual overview of storage</a></li>
  </ul></li>
  <li><a href="#how-kubernetes-keeps-things-running" id="toc-how-kubernetes-keeps-things-running" class="nav-link" data-scroll-target="#how-kubernetes-keeps-things-running"><span class="header-section-number">3.8</span> How Kubernetes keeps things running</a></li>
  <li><a href="#configuration-values" id="toc-configuration-values" class="nav-link" data-scroll-target="#configuration-values"><span class="header-section-number">3.9</span> Configuration values</a></li>
  <li><a href="#namespace" id="toc-namespace" class="nav-link" data-scroll-target="#namespace"><span class="header-section-number">3.10</span> Namespace</a></li>
  <li><a href="#network-access" id="toc-network-access" class="nav-link" data-scroll-target="#network-access"><span class="header-section-number">3.11</span> Network access</a></li>
  <li><a href="#loadbalancing" id="toc-loadbalancing" class="nav-link" data-scroll-target="#loadbalancing"><span class="header-section-number">3.12</span> LoadBalancing</a></li>
  <li><a href="#several-deployments" id="toc-several-deployments" class="nav-link" data-scroll-target="#several-deployments"><span class="header-section-number">3.13</span> Several Deployments</a></li>
  <li><a href="#sec-affinities" id="toc-sec-affinities" class="nav-link" data-scroll-target="#sec-affinities"><span class="header-section-number">3.14</span> Affinities</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../pages/Kubernetes_introduction.html">Kubernetes</a></li><li class="breadcrumb-item"><a href="../pages/Kubernetes_introduction.html">Kubernetes - introduction</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Kubernetes - introduction</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="working-progress" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Working progress</h1>
<p>Try to explain clearly what the Kubernetes elements translate to and repeat it often to clarify this vocabulary as quickly as possible. Explain everything: so start from a simple (and stupid) solution and add to it. Do not drown: keep things structured so things are not confusing.</p>
</section>
<section id="our-showcase-application-fairdom-seek" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Our showcase application: [FAIRDOM Seek]</h1>
<p>Seek is an extensive Data Management platform mostly aimed at Life Sciences but that can be used in any domain. It is a good example for going from bar metal to full cloud setup as (1) it is already available as container and bare-metal installation, with a complete Docker compose which is still easy to understand,(2) it generally relies on several containers (4 with the default docker compose), several volumes, workers (i.e.&nbsp;side process that run regularly for doing batch works), a comprehensive search using Solr, and object storage and (3) it can be run with the unique Seek container (using a sqlite database within the container) so can go from really simple (for discovery or tutorials) to rather large (with load balancing, external DB, backups) which will allow us to go from a simple and stupid (in a Kubernetes context) case to full setups with most of the cases suitable for production.</p>
<section id="seek-and-his-components" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="seek-and-his-components"><span class="header-section-number">2.1</span> Seek and his components</h2>
</section>
<section id="the-default-docker-compose" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="the-default-docker-compose"><span class="header-section-number">2.2</span> The default Docker Compose</h2>
</section>
<section id="what-could-benefit-from-a-cloud-setup" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="what-could-benefit-from-a-cloud-setup"><span class="header-section-number">2.3</span> What could benefit from a cloud setup</h2>
</section>
</section>
<section id="a-quick-overview-of-kubernetes" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> A quick overview of Kubernetes</h1>
<section id="good-free-instructory-resources" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="good-free-instructory-resources"><span class="header-section-number">3.1</span> Good free instructory resources</h2>
<section id="tutorials-and-sandboxes" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="tutorials-and-sandboxes"><span class="header-section-number">3.1.1</span> Tutorials and sandboxes</h3>
<ul>
<li><a href="https://www.youtube.com/watch?v=s_o8dwzRlu4&amp;t=3s">Kubernetes Crash Course for Absolute Beginners</a></li>
<li><a href="https://container.training/">Kubernetes online course, also containers (docker-based)</a></li>
<li><a href="https://kubebyexample.com/learning-paths/kubernetes-fundamentals/what-kubernetes-3-minutes">Kubernetes essentials, the site also offers many other useful tutorials</a></li>
<li><a href="https://labs.play-with-k8s.com/">Online Kubernetes sandbox, Play with K8s</a> and the <a href="https://training.play-with-kubernetes.com/kubernetes-workshop/">corresponding workshop</a></li>
</ul>
</section>
<section id="simple-kubernetes-setup" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="simple-kubernetes-setup"><span class="header-section-number">3.1.2</span> Simple Kubernetes setup</h3>
<p>On Windows, the simplest way to run Kubernetes is probably using Docker Desktop. A simple Kubernetes setup is part of the options.</p>
<p>On Linux, there are lightweight setup using various approached. The main ones are:</p>
<ul>
<li><a href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/">kubeadm, the official setup</a>,</li>
<li><a href="https://k3s.io/">k3s, a binary distribution, not availabe as a Windows executable, can be installed through WSL</a>,</li>
<li><a href="https://k0sproject.io/">k0s, another binary distribution, for Linux and Docker</a>,</li>
<li><a href="https://docs.rke2.io/">RKE2, another binary distribution that also works on Windows</a>,</li>
<li><a href="https://www.talos.dev/">Talos, a light Linux distribution with an integrated Kubernetes setup, can also be set-up quickly using Docker</a>,</li>
<li><a href="https://ubuntu.com/kubernetes/install">Canonical Kubernetes, a snap install for Ubuntu</a>,</li>
<li><a href="https://microk8s.io/">MicroK8s, which can be installed on Windows and Mac but shouldn’t be used on production</a>.</li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is important to consider that, if some of these setup can be used in production (such as Talos or k3s), Kubernetes is a complex system and should be probably be managed by sys-admin persons, for ensuring fault-tolerance, backups and security.</p>
</div>
</div>
</section>
</section>
<section id="terminology-main-elements" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="terminology-main-elements"><span class="header-section-number">3.2</span> Terminology &amp; main elements</h2>
<p>A first glance on Kubernetes can be very confusing. A big part of this confusion is due to a lot of “moving” parts with confusing names.</p>
<p>A full list of terms can be found on the <a href="https://kubernetes.io/docs/reference/glossary/?fundamental=true">official documentation</a>.</p>
<p>The maim terms/elements you should know are:</p>
<ul>
<li><strong>Cluster</strong>: the whole Kubernetes setup composed of several worker machines, called nodes. Some managed Kubernetes can support several clusters, so for instance give a cluster for one user.</li>
<li><strong>Node</strong>: one worker machine in Kubernetes, like a server. Can be a physical machine or a virtual machine.</li>
<li><strong>Pod</strong>: the smallest object in Kubernetes, that will run one or several containers. The containers can be run by docker or other container engines.</li>
<li><strong>Service</strong>: a fixed network endpoint to a container in Kubernetes. It allows to connect to an application in a Pod, without having this connection defined into the pod. Kubernetes often has one extra layer of access (compared to Docker Compose for instance) allowing a full decoupling of all elements. That makes it easier to change the configuration later on (automatically due to the need or from an user update).</li>
<li><strong>Label</strong>: labels are used for Kubernetes to find the different elements.</li>
<li><strong>Kubectl</strong>: the command line tool to communicate with the Kubernetes control center. With it you can create the object, update them, list them…</li>
<li><strong>Manifest</strong>: the JSON or YAML file that define a Kubernetes object. Objects are all elements of Kubernetes: Deployments, Services, ReplicaSet, DaemonSet, …</li>
</ul>
<p>And generally, the applications are deployed as:</p>
<ul>
<li><strong>ReplicatSet</strong>: ask for a set numbers of Pods. Kubernetes will try to have the set number of pods running, and will restore this which might become unhealthy. The pods can be on any node and it is not guaranteed that Kubernetes will be able to get the right number of pods (if there isn’t enough resources typically). It is possible to influence on which node the pods will run using affinities, see <a href="#sec-affinities" class="quarto-xref">Section&nbsp;3.14</a></li>
<li><strong>Deployment:</strong> manages a ReplicaSet and provides rolling updates. It allows you to update an application without downtime by gradually replacing old Pods with new ones. If something goes wrong, you can roll back to a previous version.</li>
<li><strong>DaemonSet:</strong> ensures that one Pod runs on each (or some) node. It is typically used for system-level services such as monitoring agents, log collectors, or networking tools that need to run everywhere.</li>
<li><strong>StatefulSet:</strong> manages Pods that need stable, unique identities and persistent storage. It is used for stateful applications such as databases or distributed systems that need predictable network names or data persistence.</li>
<li><strong>Job:</strong> runs Pods to completion. It is used for tasks that need to run once or a fixed number of times, such as batch processing or data import. When the Job finishes successfully, the Pods are not restarted.</li>
<li><strong>ConfigMap:</strong> stores non-confidential configuration data as key-value pairs. Applications can use ConfigMaps to configure themselves without having to rebuild their containers.</li>
<li><strong>Secret:</strong> similar to ConfigMap, but used to store sensitive information such as passwords, tokens, or SSH keys. Secrets are stored in base64-encoded form and can be mounted into Pods or used as environment variables. Be aware that they are not an encrypted, only encoded, so the security is ensured by having the secret saved in a private place. As such it is only moderately secured.</li>
</ul>
</section>
<section id="everything-decoupled" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="everything-decoupled"><span class="header-section-number">3.3</span> Everything decoupled</h2>
<p>How Kubernetes makes everything through API and labels Why there is so many extra layers compared to docker compose -&gt; full decoupling.</p>
</section>
<section id="the-various-objects-for-your-application" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="the-various-objects-for-your-application"><span class="header-section-number">3.4</span> The various objects for your application</h2>
<p>Deployment, Job, ReplicaSet, DaemonSet, StatefulSet</p>
<p>While the <strong>Pod</strong> is the smallest element in Kubernetes, it is directly started <em>only</em> for testing. If you define a pod or create it using <code>kubectl</code>, it will only run once and will not be restarted if something fails. As such, it is like <code>docker run</code> if started manually, or <code>docker compose</code> if started using a manifest, and offers no benefit — just the added complexity of the Kubernetes setup.</p>
<p>A <strong>ReplicaSet</strong> asks for a set number of pods, and Kubernetes will ensure that these pods are always running. If one pod becomes unhealthy or crashes, Kubernetes automatically removes it and creates a new one.</p>
<p>A <strong>Deployment</strong> is what you usually use for applications. It manages ReplicaSets and provides updates and rollbacks. You can think of it as “the normal way” to run an app on Kubernetes — one that should always be available and easy to update.</p>
<p>A <strong>Job</strong> is used for tasks that need to run once and then stop, for example, a script that imports some data or cleans up files. Kubernetes ensures that the job runs successfully to completion.</p>
<p>A <strong>DaemonSet</strong> runs one pod per machine (node). This is often used for background services such as system monitoring or log collection that must run everywhere.</p>
<p>A <strong>StatefulSet</strong> is like a Deployment but for applications that need to keep their identity and data across restarts — such as databases. Each pod in a StatefulSet has a fixed name and can have its own storage attached.</p>
</section>
<section id="visual-overview" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="visual-overview"><span class="header-section-number">3.5</span> Visual overview</h2>
<p>Here’s a simple way to picture how Kubernetes manages your applications: +—————————————————-+ | Deployment | | (defines the app, version, and update strategy) | | | | +——————————————–+ | | | ReplicaSet | | | | (keeps the right number of Pods running) | | | | | | | | +———–+ +———–+ +——-+| | | | | Pod 1 | | Pod 2 | | Pod 3 || | | | | (runs app)| | (runs app)| |(app) || | | | +———–+ +———–+ +——-+| | | +——————————————–+ | +—————————————————-+ * Deployment: Defines what you want to run and how to update it. * ReplicaSet: Ensures the right number of pods are running. * Pods: Run the actual container (your app).</p>
<p>If a pod fails, the ReplicaSet creates a new one. If you update your app, the Deployment creates a new ReplicaSet with the new version and removes the old one once everything runs correctly. —</p>
</section>
<section id="updating-an-application" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="updating-an-application"><span class="header-section-number">3.6</span> Updating an application</h2>
<p>Applications are still running in containers, so updating means updating the container image. If <strong>Deployments</strong> are used, the update is managed automatically by Kubernetes: it follows an update strategy to start new containers while stopping and removing the old ones. This allows smooth, gradual updates with no downtime.</p>
<p>You can also roll back easily if something goes wrong, as Kubernetes keeps the previous version ready.</p>
<hr>
</section>
<section id="where-do-you-store-the-data" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="where-do-you-store-the-data"><span class="header-section-number">3.7</span> Where do you store the data</h2>
<p>Containers are temporary — when they stop, everything inside disappears. For most applications, you need to keep data somewhere safe and separate from the containers. The common way to store data in Kubernetes is in <strong>volumes</strong>.</p>
<p>A <strong>Volume</strong> is a piece of storage that can be attached to a pod. It can be on the same machine, on a network drive, or in the cloud. Kubernetes makes sure that your pods can access this storage whenever they run.</p>
<p>If you need data that must stay linked to a specific pod (for example, for a database), you can use a <strong>PersistentVolume</strong> and a <strong>PersistentVolumeClaim</strong>. These ensure that even if your pods are restarted or moved to another machine, your data stays available and safe.</p>
<p>In short:</p>
<ul>
<li>Pods are temporary.</li>
<li>Data should live in Volumes or PersistentVolumes.</li>
<li>Kubernetes handles the connection between the app and its data storage.</li>
</ul>
<p><em>For review:</em> But you can also store your data in a <strong>database</strong> or an <strong>object storage</strong> (such as an S3 implementations). They might be part of the Kubernetes cluster, in another Kubernetes cluster, or fully external. Their access and usage will generally be the same in all cases. When within a Kubernetes cluster, they use volumes of their own and their setup could involve setting-up the volumes (see the note below). Some data storage (such as Postgresql) might be managed by an <strong>operator</strong>. <em>Operators</em> are software extensions of Kubernetes, that can define, as their name implies, operations on the cluster. In that case, you generally set-up the database and the operator as instructed by the operator documentation, and you will then have the database managed by the operator. They could take care of data replication, failure management, …, and are generally the prefered way to set-up a data storage on Kubernetes when something more than a simple volume is needed.</p>
<hr>
<section id="a-note-about-automatic-storage-storageclass" class="level3" data-number="3.7.1">
<h3 data-number="3.7.1" class="anchored" data-anchor-id="a-note-about-automatic-storage-storageclass"><span class="header-section-number">3.7.1</span> A note about automatic storage (StorageClass)</h3>
<p>Kubernetes can automatically create persistent storage for you — but <strong>only if the cluster has been set up with a storage backend</strong>.</p>
<p>When you create a <strong>PersistentVolumeClaim (PVC)</strong>, Kubernetes checks if there is a <strong>StorageClass</strong> available. The StorageClass defines <em>how</em> to create the actual storage — for example, on cloud disks, local drives, or network storage. If one is available, Kubernetes provisions the storage automatically and attaches it to your pod.</p>
<p>If no StorageClass or backend is configured, the claim will just wait forever (in <em>Pending</em> state), and your pod won’t start. So persistence only works if the cluster administrator configured it in advance.</p>
<p>In short:</p>
<ul>
<li>Cloud clusters (AWS, Google, Azure) usually have a StorageClass ready by default.</li>
<li>Local or on-premise clusters might need to install one manually (for example, a <strong>local-path-provisioner</strong> or <strong>NFS</strong>).</li>
</ul>
<hr>
</section>
<section id="visual-overview-of-automatic-storage-provisioning" class="level3" data-number="3.7.2">
<h3 data-number="3.7.2" class="anchored" data-anchor-id="visual-overview-of-automatic-storage-provisioning"><span class="header-section-number">3.7.2</span> Visual overview of automatic storage provisioning</h3>
<pre><code>+-----------------------------------------------+
|                 Your Pod                      |
|        (requests storage via PVC)             |
+-----------------------------------------------+
                      |
                      v
+-----------------------------------------------+
| PersistentVolumeClaim (PVC)                   |
| "I need 10 GB of storage, please."            |
+-----------------------------------------------+
                      |
                      v
+-----------------------------------------------+
| StorageClass (defines how to create storage)  |
| Example: AWS EBS, Google PD, NFS, Local Path  |
+-----------------------------------------------+
                      |
                      v
+-----------------------------------------------+
| PersistentVolume (PV)                         |
| Actual disk or network storage created        |
| automatically by the provisioner              |
+-----------------------------------------------+</code></pre>
<p>If a suitable <strong>StorageClass</strong> is present, the system automatically creates a <strong>PersistentVolume</strong> and binds it to your claim. Otherwise, the claim just stays pending until an administrator provides a volume manually.</p>
<hr>
</section>
<section id="visual-overview-of-storage" class="level3" data-number="3.7.3">
<h3 data-number="3.7.3" class="anchored" data-anchor-id="visual-overview-of-storage"><span class="header-section-number">3.7.3</span> Visual overview of storage</h3>
<pre><code>+----------------------------+
|          Pod               |
|  (runs your container app) |
|          |                 |
|          | uses            |
|          v                 |
|      +--------+            |
|      | Volume |------------+--------------+
|      +--------+                           |
+-------------------------------------------|
                                            |
                           +--------------------------------+
                           | PersistentVolumeClaim (PVC)    |
                           |  (requests storage from pool)  |
                           +--------------------------------+
                                            |
                           +--------------------------------+
                           | PersistentVolume (PV)          |
                           | (actual disk / network storage)|
                           +--------------------------------+</code></pre>
<ul>
<li><strong>Pod</strong>: The running container that needs to read or write data.</li>
<li><strong>Volume</strong>: The connection point between the app and the storage.</li>
<li><strong>PersistentVolumeClaim (PVC)</strong>: A request for storage.</li>
<li><strong>PersistentVolume (PV)</strong>: The real storage space (disk, cloud volume, etc.).</li>
</ul>
<p>This structure lets you move or restart pods without losing any data — Kubernetes will reconnect the storage automatically.</p>
<hr>
</section>
</section>
<section id="how-kubernetes-keeps-things-running" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="how-kubernetes-keeps-things-running"><span class="header-section-number">3.8</span> How Kubernetes keeps things running</h2>
<p>Kubernetes is designed to make sure your applications stay up and running, even if something fails. It constantly watches all your pods and checks if they are healthy.</p>
<p>If a pod crashes, Kubernetes automatically restarts it or creates a new one. If a whole machine (called a <em>node</em>) goes down, Kubernetes moves your pods to another available machine.</p>
<p>You don’t need to manually restart or move anything — Kubernetes takes care of it. This is one of its biggest advantages compared to running containers manually: you describe <em>what you want to run</em>, and Kubernetes makes sure it <em>stays</em> that way.</p>
</section>
<section id="configuration-values" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="configuration-values"><span class="header-section-number">3.9</span> Configuration values</h2>
<p>ConfigMap and Secrets</p>
<p>Regular Values can be stored in a ConfigMap, while values that should be hidden are store in Secrets. The main idea of Secrets is to keep your confidential values <strong>out</strong> of the regular configuration, in a secure place. Secret values are encoded in Base64 for preventing issues with special characters but it does not offer any added security (it can be decoded with any Base64 decoding tool).</p>
</section>
<section id="namespace" class="level2" data-number="3.10">
<h2 data-number="3.10" class="anchored" data-anchor-id="namespace"><span class="header-section-number">3.10</span> Namespace</h2>
</section>
<section id="network-access" class="level2" data-number="3.11">
<h2 data-number="3.11" class="anchored" data-anchor-id="network-access"><span class="header-section-number">3.11</span> Network access</h2>
</section>
<section id="loadbalancing" class="level2" data-number="3.12">
<h2 data-number="3.12" class="anchored" data-anchor-id="loadbalancing"><span class="header-section-number">3.12</span> LoadBalancing</h2>
</section>
<section id="several-deployments" class="level2" data-number="3.13">
<h2 data-number="3.13" class="anchored" data-anchor-id="several-deployments"><span class="header-section-number">3.13</span> Several Deployments</h2>
<p>kustomize</p>
<p>helm</p>
</section>
<section id="sec-affinities" class="level2" data-number="3.14">
<h2 data-number="3.14" class="anchored" data-anchor-id="sec-affinities"><span class="header-section-number">3.14</span> Affinities</h2>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/abecam\.github\.io\/DeKCD-DMOnTheCloud\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>